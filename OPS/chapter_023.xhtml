<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
	<title>ПРОГРАММИРОВАНИЕ - ВВЕДЕНИЕ В ПРОФЕССИЮ I: АЗЫ ПРОГРАММИРОВАНИЯ</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="css/stylesheet.css" type="text/css" />
</head>
<body>
<section class="body-rw Chapter-rw" epub:type="bodymatter chapter">
<header>
	<h4>1.4.16. Графическая подсистема в ОС Unix</h4>
</header>

<br/>
<h5>Общие сведения</h5>
<br/>

<p>В отличие от некоторых других систем, ОС Unix сама по себе не включает никаких средств поддержки графического интерфейса. Для работы в графическом режиме в ОС Unix используется программный комплекс под общим названием X Window System, который состоит из обычных пользовательских программ и не является, вообще говоря, частью операционной системы.</p>

<br/>
<small>
	<p>Иногда можно встретить в литературе и разговорах наименование &#171;XWindows&#187;. Такое наименование является категорически неправильным, что создатели системы X Window настойчиво подчеркивают. Слово &#171;window&#187; (окно) в наименовании этой системы должно стоять в единственном числе.</p>
</small>
<br/>

<p>Центральным компонентом X Window System является программа, отвечающая за отображение графической информации на дисплее пользователя. Эта программа называется <i>X-сервером</i>. Все приложения, использующие графику, обращаются к X-серверу с запросами на вывод того или иного изображения; таким образом, X-сервер предоставляет приложениям <i>услугу</i> (сервис) отображения графической информации, откуда и происходит название &#171;X-сервер&#187;. Программы, обращающи- еся к X-серверу (то есть все программы, работающие в ОС Unix и использующие графику), называются, соответственно, X-клиентами.</p>

<p>Отдельного упоминания заслуживают X-клиенты специального типа, называемые <i>оконными менеджерами</i>. Оконный менеджер отвечает за обрамление появляющихся на экране окон&#160;&#8212; отрисовывает рамки и заголовки окон, позволяет перемещать окна по экрану и менять их размеры. Авторам других графических программ, как следствие, не нужно думать о декоре окна; обычно X-приложение отвечает только за отрисовку прямоугольной области экрана, не имеющей ни рамки, ни заголовка, ни прочих стандартных элементов декора окна. С другой стороны, и пользователь в этой ситуации может выбрать из нескольких оконных менеджеров тот, который лучше отвечает его индивидуальным склонностям и потребностям.</p>

<br/>
<small>
	<p>Автор в свое время любил демонстрировать &#171;непосвященным&#187; простенький фокус, состоявший в замене &#171;на лету&#187; оконного менеджера с аскетично выглядящего fvwm2 на fvwm95, в мельчайших подробностях копирующий внешний вид MS Windows-95. Особенно почему-то впечатляет зрителей тот факт, что открытые приложения при этом никуда не деваются.</p>
</small>
<br/>

<p>Одной из самых популярных X-клиентских программ является xterm&#160;&#8212; эмулятор алфавитно-цифрового дисплея для X Window. В работе может быть удобно завести одновременно несколько экземпляров процесса xterm, каждый из которых порождает своё окно, в котором запускает копию интерпретатора командной строки. В одном окне мы можем запускать редактор vim, в другом&#160;&#8212; выполнять трансляцию и отладку, в третьем&#160;&#8212; запускать тестовые программы и т. д.</p>

<br/>
<h5>Запуск X Window и выбор оконного менеджера</h5>
<br/>

<p>В зависимости от конфигурации конкретной машины система X Window может оказаться уже запущена, либо вам будет нужно запустить её самостоятельно. Обычно это делается с помощью команды startx, которая, в свою очередь, запускает программу xinit.</p>

<br/>
<small>
	<p>Возможно, в вашей локальной сети присутствует машина, выполняющая роль сервера приложений на основе xdm; к такой машине можно подключиться с помощью штатных средств X Window таким образом, что все ваши программы будут выполняться на этой (удалённой) машине, а на вашем локальном рабочем месте будет осуществляться только отображение их графических окон, т. е. ваш компьютер будет играть роль X-терминала. Чтобы проверить, есть ли в вашей сети xdm-сервера, попробуйте дать команду &#171;X -broadcast&#187; Если xdm-сервер в вашей сети действительно есть, после переключения в графический режим вы увидите приглашение к вводу имени и пароля для входа на этот сервер. Если xdm-серверов в сети больше одного, сначала вы увидите их список с предложением выбрать, услугами какого из них вы желаете воспользоваться. Если в течение 15–20 секунд после перехода в графический режим ничего подобного не произошло&#160;&#8212; скорее всего, xdm-сервер в вашей сети отсутствует.</p>
</small>
<br/>

<p>Команда startx вместе с X-сервером запустит для вас тот или иной оконный менеджер. В некоторых системах оконный менеджер можно выбрать из меню, появляющегося сразу после запуска X Window, в других системах выбор конкретного оконного менеджера определяется конфигурацией.</p>

<p>Если конфигурация системы вас по тем или иным причинам не устраивает, вы можете настроить её по своему вкусу путём создания в домашней директории файла с именем .xinitrc (либо его редактирования, если такой файл уже есть). Обратите внимание на точку перед именем файла, она важна. По сути .xinitrc представляет собой командный файл, из которого запускаются прикладные программы, включая и сам оконный менеджер. Программа xinit запускает X-сервер, а затем, соответствующим образом установив переменные окружения, начинает выполнение команд из .xinitrc. Завершение выполнения .xinitrc означает завершение сеанса работы с X Window, при этом процесс X-сервера завершается. Простейший пример .xinitrc может выглядеть примерно так:</p>

<br/>
<p class="codecite">
&#160;&#160;&#160;&#160;xterm &#38;<br/>
&#160;&#160;&#160;&#160;twm<br/>
</p>
<br/>

<p>В этом случае сначала будет запущен xterm (его мы запускаем на всякий случай, чтобы можно было работать, даже если оконный менеджер имеет неудобную конфигурацию), после чего&#160;&#8212; стандартный оконный менеджер twm. Обратите внимание, что xterm запускается в фоновом режиме (для этого в конце первой строки поставлен знак &#38;). Это сделано, чтобы не ожидать его завершения для запуска twm.</p>

<p>Оконный менеджер twm достаточно примитивен. Хотя некоторые пользователи Unix используют именно его <a epub:type="noteref" href="#n1_1_32">32</a>, вы, возможно, захотите попробовать другие оконные менеджеры. В вашей системе могут быть установлены, кроме twm, такие оконные менеджеры, как FVWM, IceWM, WindowMaker, Fluxbox и другие; кроме того, вы можете обнаружить и более развитые ОМ, такие как KDE и GNOME <a epub:type="noteref" href="#n1_1_33">33</a>. Чтобы воспользоваться IceWM, измените ваш .xinitrc:</p>

<br/>
<p class="codecite">
&#160;&#160;&#160;&#160;xterm &#38;<br/>
&#160;&#160;&#160;&#160;icewm<br/>
</p>
<br/>

<p>Если вы предпочитаете KDE, ваш файл может выглядеть так:</p>

<br/>
<p class="codecite">
&#160;&#160;&#160;&#160;xterm &#38;<br/>
&#160;&#160;&#160;&#160;startkde<br/>
</p>
<br/>

<p>Выбор конкретного оконного менеджера среди множества доступных зависит в основном от ваших личных предпочтений. Так, стандартный ОМ twm выглядит достаточно аскетично, тогда как KDE по вычурности своего графического дизайна, пожалуй, превосходит системы семейства Windows. В то же время KDE весьма требователен к ресурсам и ощутимо &#171;тормозит&#187; даже на сравнительно быстрых компьютерах, тогда как аскетичные twm, fvwm и даже достаточно развитый в дизайнерском отношении icewm работают с приемлемой скоростью даже на компьютерах с процессорами Pentium-1 (KDE на таких машинах лучше и не пробовать запускать).</p>

<p>Отметим, что KDE предназначен в основном для пользователей, не умеющих и не желающих работать в командной строке. Профессиональные программисты и системные администраторы обычно предпочитают оконные менеджеры попроще.</p>

<br/>
<h5>Работа с классическими оконными менеджерами</h5>
<br/>

<p>К классическим ОМ мы относим twm, fvwm и некоторые другие. Следует отметить, что любой оконный менеджер имеет весьма развитые средства настройки, позволяющие существенно изменить его поведение, так что дать исчерпывающую инструкцию по работе с каким-либо из оконных менеджеров на уровне &#171;нажмите такую-то клавишу для получения такого-то результата&#187; было бы затруднительно. В этом параграфе мы ограничимся общими рекомендациями, которые позволят вам быстро освоить работу с вашим оконным менеджером в той конфигурации, которая установлена в вашей системе. При желании вы можете изменить любые настройки оконного менеджера; за инструкциями по этому поводу следует обратиться к технической документации.</p>

<p>Итак, первое, что можно посоветовать после запуска оконного менеджера&#160;&#8212; это попытаться понять, каким образом в нем высветить главное меню. Во всех классических ОМ главное меню выдаётся, если щёлкнуть левой кнопкой мыши <i>в любом свободном месте экрана</i> (то есть в таком месте, которое не закрыто никакими окнами). Отметим, что в классических ОМ не поддерживается ничего похожего на &#171;пиктограммы на рабочем столе&#187;, так что запуск программ можно осуществить либо через меню, либо с помощью командной строки, доступ к которой можно получить, запустив программу xterm или аналогичную. Обычно xterm или какой-то его аналог имеется либо в самом главном меню, либо в его подменю, называемом &#171;terminals&#187;, &#171;shells&#187; и т. п. Если у вас уже есть одно окошко с командной строкой, можно запустить новый экземпляр xterm, дав команду</p>

<br/>
<p class="codecite">
&#160;&#160;&#160;&#160;xterm &#38;<br/>
</p>
<br/>

<p>Обратите внимание на символ &#171;&#38;&#187;. Программу xterm мы запускаем в фоновом режиме, чтобы старый экземпляр xterm (с помощью которого мы даём команду) не ждал его завершения: в противном случае запуск нового xterm теряет смысл, ведь у нас во время его работы не будет возможности пользоваться старым экземпляром.</p>

<p>Программа xterm имеет развитую систему опций. Например,</p>

<br/>
<p class="codecite">
&#160;&#160;&#160;&#160;xterm -bg black -fg gray &#38;<br/>
</p>
<br/>

<p>запустит эмулятор терминала на черном фоне с серыми буквами (тот же набор цветов обычно используется в текстовой консоли).</p>

<p>Классическим в системе X Window считается поведение, при котором фокус ввода находится в том окне, в котором расположен курсор мыши <a epub:type="noteref" href="#n1_1_34">34</a>. Такое соглашение позволяет, например, работать с окном, которое частично скрыто другими окнами, не вытаскивая его на верхний уровень. Такое поведение (именуемое FocusFollowsMouse), однако, может оказаться непривычным; при необходимости его можно сменить на более привычное, называемое ClickToFocus, с помощью настроек вашего оконного менеджера. В любом случае следите внимательно за положением курсора мыши.</p>

<p>Показать полностью (поднять на верхний уровень) окно, которое частично скрыто, можно, щёлкнув мышью по его <i>заголовку</i> (а не по любому месту окна). Ваши настройки могут предусматривать и обратную операцию (&#171;утопить&#187; окно, показав то, что под ним)&#160;&#8212; обычно это делается &#171;щелчком&#187; <i>правой</i> кнопки мыши по заголовку. Для перемещения окна по экрану также служит его заголовок: достаточно навести на заголовок курсор мыши, нажать (и не отпускать) левую кнопку, выбрать новое положение окна и отпустить кнопку. Если заголовка окна не видно (например, он скрыт под другими окнами), ту же операцию можно проделать с помощью вертикальных и горизонтальных частей рамки окна, кроме выделенных участков в уголках рамки; эти угловые участки служат для изменения размеров окна, то есть при протягивании их мышкой перемещается не всё окно, а только тот его уголок, который вы захватили.</p>

<p>Если вы потеряли нужное вам окно, обычно его можно легко отыскать, щёлкнув <i>правой</i> кнопкой мыши в свободном месте экрана. Обычно при этом выдаётся меню, состоящее из списка существующих окон.</p>

<p>В большинстве случаев оконные менеджеры поддерживают так называемый виртуальный рабочий стол (virtual desktop), состоящий из нескольких &#171;виртуальных экранов&#187;, на каждом из которых можно разместить свои окна. Это бывает удобно, если вы работаете одновременно с большим количеством окон. Карта виртуального рабочего стола, на которой изображены виртуальные экраны, обычно находится в правом нижнем углу экрана; чтобы переключиться на нужный вам виртуальный экран, достаточно щёлкнуть мышью в соответствующем месте карты.</p>

<p>Из окон, в которых отображается некий текст, обычно можно скопировать этот текст в другие окна. Для этого достаточно выделить текст мышью; в большинстве программ, работающих под управлением X Window, нет специальной операции &#171;copy&#187;: копируется тот текст, который выделен. Вставка выделенного текста осуществляется <i>третьей</i> (средней) кнопкой мыши. Скорее всего, ваша мышь оснащена &#171;колесом&#187; для скроллинга; обратите внимание на то, что на это колесо можно нажать сверху вниз, не прокручивая его, и тогда оно сработает как обычная (третья) кнопка, что вам, собственно, и требуется.</p>


<aside epub:type="footnote" id="n1_1_32">
	<p>Надо сказать, что twm в системе присутствует практически всегда, чего о других оконных менеджерах не скажешь.</p>
</aside>
<aside epub:type="footnote" id="n1_1_33">
	<p>Всего существует несколько десятков оконных менеджеров, так что приведённый список не может претендовать на полноту.</p>
</aside>
<aside epub:type="footnote" id="n1_1_34">
	<p>Это отличается от поведения в Windows, где для перемещения фокуса ввода необходимо выбрать окно, щёлкнув по нему мышкой, при этом окно обязательно показывается полностью.</p>
</aside>

</section>
</body>
</html>