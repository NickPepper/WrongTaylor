<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
	<title>ПРОГРАММИРОВАНИЕ - ВВЕДЕНИЕ В ПРОФЕССИЮ I: АЗЫ ПРОГРАММИРОВАНИЯ</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="css/stylesheet.css" type="text/css" />
</head>
<body>
<section class="body-rw Chapter-rw" epub:type="bodymatter chapter">
<header>
	<h4>1.4.8. Выполнение в фоновом режиме</h4>
</header>

<p>Некоторые программы выполняются в течение длительного времени, при этом не требуя взаимодействия с пользователем через стандартные потоки ввода/вывода. Во время выполнения таких программ удобно иметь возможность продолжать давать команды командному интерпретатору, чтобы не тратить время.</p>

<p>Допустим, нам потребовалось обновить базу данных для команды locate, которая позволяет находить файлы в системе по части имени. В норме эта база данных обновляется автоматически, но обычно это происходит в ночное время, а если мы привыкли выключать наш компьютер на ночь, то данные, используемые программой locate, могут изрядно устареть. Обновление делается командой updatedb, выполнение которой может занять несколько минут. Ждать её окончания нам бы не хотелось, поскольку эти несколько минут мы могли бы, например, использовать для набора текста в редакторе. Чтобы запустить команду в фоновом режиме, к ней следует в конце приписать символ &#38;, например:</p>

<br/>
<p class="codecite">
&#36; updatedb &#38;<br/>
[1] 2437<br/>
</p>
<br/>

<p>В ответ на нашу команду система сообщает, что задание запущено в фоновом режиме в качестве фоновой задачи &#8470;1, причём номер запущенного процесса&#160;&#8212; 2437. Текущий список выполняемых фоновых задач можно узнать командой jobs:</p>

<br/>
<p class="codecite">
&#36; jobs<br/>
[1]+&#160;&#160;Running&#160;&#160;&#160;&#160;updatedb &#38;<br/>
</p>
<br/>

<p>После завершения задачи командный интерпретатор нам об этом сообщит. В случае успешного завершения сообщение будет выглядеть так:</p>

<br/>
<p class="codecite">
&#36; jobs<br/>
[1]+&#160;&#160;Done&#160;&#160;&#160;&#160;updatedb &#38;<br/>
</p>
<br/>

<p>Если же программа при завершении сообщила операционной системе, что не считает своё выполнение успешным (с updatedb такое случается редко, с другими программами&#160;&#8212; гораздо чаще), сообщение будет иметь другой вид:</p>

<br/>
<p class="codecite">
&#36; jobs<br/>
[1]+&#160;&#160;Exit 1&#160;&#160;&#160;&#160;updatedb &#38;<br/>
</p>
<br/>

<p>Наконец, если фоновый процесс снять сигналом, сообщение будет примерно таким (для сигнала SIGTERM):</p>

<br/>
<p class="codecite">
&#36; jobs<br/>
[1]+&#160;&#160;Terminated&#160;&#160;&#160;&#160;updatedb &#38;<br/>
</p>
<br/>

<p>При отправлении сигналов процессам, являющимся фоновыми задачами данного конкретного экземпляра командного интерпретатора, можно ссылаться на номера процессов по номерам фоновых задач, добавляя к номеру символ &#171;%&#187;. Так, команда &#171;kill %2&#187; отправит сигнал SIGTERM второй фоновой задаче. Символ &#171;%&#187; без указания номера обозначает последнюю из фоновых задач.</p>

<p>Если задача уже запущена не в фоновом режиме и нам не хочется ждать её завершения, мы можем сделать обычную задачу фоновой. Для этого следует нажать Ctrl-Z, в результате чего выполнение текущей задачи будет приостановлено. Затем с помощью команды bg <a epub:type="noteref" href="#n1_1_26">26</a> приостановленную задачу можно снова поставить на выполнение, но уже в фоновом режиме. Также возможно сделать текущей (т. е. такой, окончания которой ожидает командный интерпретатор) любую из фоновых и приостановленных задач. Это делается с помощью команды fg <a epub:type="noteref" href="#n1_1_27">27</a>.</p>

<p><strong>Помните: комбинация Ctrl-Z не убивает активную задачу, а лишь временно приостанавливает её выполнение</strong>. Это особенно важно для тех, кто привык к работе с &#171;консольными&#187; программами в Windows; там эта комбинация имеет совершенно иной смысл. Если вы привыкли к ней&#160;&#8212; значит, пора отвыкать.</p>

<p>Отметим, что возможности фонового исполнения особенно полезны при запуске оконных приложений&#160;&#8212; web-браузера, редактора текстов, работающего в отдельном окне (например, geany) или просто другого экземпляра xterm. Запустив на исполнение такую программу, мы, как правило, совершенно не хотим, чтобы наш командный интерпретатор ждал её завершения, не принимая от нас новых команд.</p>


<aside epub:type="footnote" id="n1_1_26">
	<p>От английского background&#160;&#8212; &#171;фон&#187;.</p>
</aside>
<aside epub:type="footnote" id="n1_1_27">
	<p>От английского foreground&#160;&#8212; &#171;передний план&#187;.</p>
</aside>
</section>
</body>
</html>